<!DOCTYPE html>
<html>
<head>
  <title>Resilience Terminal</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<h1 class="glow">RESILIENCE TERMINAL</h1>
<a href="/logout" style="color:#ff4d4d;">Disconnect</a>

<div class="container">
  <ul id="messages"></ul>
  <input id="input" autocomplete="off" placeholder="Type message..." />
  <button onclick="send()">Transmit</button>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
const socket = io();
const input = document.getElementById("input");
const messages = document.getElementById("messages");

// We'll pass the username from server using a global variable
// For now, we assume server injects it in the page
const username = window.USERNAME || "Unknown";

function send() {
  if (input.value !== "") {
    // Send an object instead of plain string
    socket.emit("chat message", {
      user: username,
      text: input.value
    });
    input.value = "";
  }
}

// Listen for messages
socket.on("chat message", (msg) => {
  const li = document.createElement("li");
  li.textContent = msg.user + " >> " + msg.text;
  messages.appendChild(li);
});
</script>


</body>
</html>

